<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Day 66 Lab - User & Group Management</title>
  <link rel="stylesheet" href="../assets/lab.css" />
</head>
<body>
  <div class="lab-container">
    <h1>Day 66 Lab</h1>
    <h2>User & Group Management</h2>

    <p><strong>Objective:</strong> Create and manage users and groups, grant limited admin rights, inspect account metadata, and safely remove accounts.</p>

    <h3>ðŸ›  Tools Needed</h3>
    <ul>
      <li>Linux system (VM, WSL, or cloud instance)</li>
      <li><strong>sudo privileges</strong> for administrative commands</li>
    </ul>

    <h3>Step 1: Inspect Your Current Identity</h3>
<pre><code>whoami
id
groups
</code></pre>

    <h3>Step 2: Create a Practice Group</h3>
<pre><code>sudo groupadd interns
getent group interns
</code></pre>

    <h3>Step 3: Create a New User (with Home & Default Shell)</h3>
    <p>Use your distroâ€™s helper if available (<code>adduser</code> on Debian/Ubuntu) or the portable low-level tool <code>useradd</code>.</p>
<pre><code># Debian/Ubuntu (interactive, prompts for password & details)
sudo adduser trainee

# Portable approach (create home, set shell, then set password)
sudo useradd -m -s /bin/bash trainee
sudo passwd trainee
</code></pre>
    <p>Verify account entry and home directory:</p>
<pre><code>getent passwd trainee
ls -la /home/trainee
</code></pre>

    <h3>Step 4: Add User to Groups</h3>
    <p>Add <code>trainee</code> to the <code>interns</code> group (and verify):</p>
<pre><code>sudo usermod -aG interns trainee
id trainee
groups trainee
getent group interns
</code></pre>

    <h3>Step 5: Grant Limited Admin (sudo/wheel)</h3>
    <p>On Debian/Ubuntu, admin group is <code>sudo</code>. On RHEL/Fedora, itâ€™s <code>wheel</code>.</p>
<pre><code># Debian/Ubuntu
sudo usermod -aG sudo trainee

# RHEL/Fedora
# sudo usermod -aG wheel trainee
</code></pre>
    <p>Sanity-check sudo with a non-destructive command:</p>
<pre><code>su - trainee
sudo -v              # cache credentials (will prompt for password)
sudo id              # should show effective root
exit                 # return to your original user
</code></pre>

    <h3>Step 6: List & Understand Account Databases</h3>
<pre><code># Accounts and shells
getent passwd | head
getent group  | head
cat /etc/shells
</code></pre>

    <h3>Step 7: Manage Password / Expiration Policy</h3>
<pre><code># Show aging info (requires shadow access â†’ use sudo)
sudo chage -l trainee

# Example: force password change on next login
sudo chage -d 0 trainee
</code></pre>

    <h3>Step 8: Lock / Unlock Account (No Deletion)</h3>
<pre><code># Lock login (prefixes '!' in shadow)
sudo usermod -L trainee
sudo passwd -S trainee

# Unlock
sudo usermod -U trainee
sudo passwd -S trainee
</code></pre>

    <h3>Step 9: Change Primary Group / Default Shell (Optional)</h3>
<pre><code># Change primary group to interns
sudo usermod -g interns trainee
id trainee

# Change default shell
sudo usermod -s /bin/zsh trainee
getent passwd trainee
</code></pre>

    <h3>Step 10: Remove User Safely</h3>
    <p><strong>Note:</strong> Only do this in your lab VM. <code>-r</code> removes the userâ€™s home directory.</p>
<pre><code>sudo userdel -r trainee
getent passwd trainee || echo "trainee removed"
</code></pre>

    <h3>âœ… Deliverables</h3>
    <ul>
      <li>Screenshot of <code>getent group interns</code> after creation</li>
      <li>Screenshot of <code>id trainee</code> showing membership in <code>interns</code> (and <code>sudo</code>/<code>wheel</code> if applicable)</li>
      <li>Screenshot of <code>sudo chage -l trainee</code> output</li>
      <li>Screenshot proving lock/unlock with <code>passwd -S trainee</code> (before deletion)</li>
    </ul>

    <h3>ðŸŽ¯ Stretch Goals (Optional)</h3>
    <ul>
      <li>Create a shared project dir owned by group <code>interns</code>, setgid for collaborative files:
        <pre><code>sudo mkdir -p /srv/project
sudo chgrp interns /srv/project
sudo chmod 2775 /srv/project
getfacl /srv/project 2>/dev/null || ls -ld /srv/project
</code></pre>
      </li>
      <li>Add an extra user (<code>assistant</code>) and verify both users can collaborate in <code>/srv/project</code>.</li>
      <li>Restrict a userâ€™s shell to <code>/usr/sbin/nologin</code> for service-only accounts and verify login behavior.</li>
    </ul>

    <h3>ðŸ§  Reflect</h3>
    <ol>
      <li>When would you choose to <em>lock</em> an account instead of deleting it?</li>
      <li>Why use <code>usermod -aG</code> (append) rather than overwriting the group list?</li>
      <li>What risks come with adding users to <code>sudo</code>/<code>wheel</code>, and how do you mitigate them?</li>
    </ol>

    <hr />
    <p><strong>Lab Summary:</strong> You created users and groups, adjusted membership, granted limited admin rights, inspected account metadata, enforced password policy, locked/unlocked accounts, and removed users cleanly.</p>
  </div>
</body>
</html>
